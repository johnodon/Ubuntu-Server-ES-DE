sudo sed -i -e '$a\arcade ALL=(ALL) NOPASSWD:ALL' /etc/sudoers
sudo add-apt-repository universe -y
sudo add-apt-repository multiverse -y
sudo apt update -y && sudo apt dist-upgrade -y
sudo apt install xorg openbox obconf lxterminal inxi yad screen lxappearance xterm nemo nano feh lxpolkit firefox rofi lightdm libfuse2 samba git dialog pulseaudio pavucontrol unzip xmlstarlet mpv dos2unix mc p7zip build-essential libsdl2-dev libsdl2-gfx-dev libsdl2-ttf-dev libvorbis-dev net-tools libsdl2-image-dev autotools-dev scrot jstest-gtk --no-install-recommends -y

sudo nano /etc/samba/smb.conf
[Home]
path = /home/arcade
public = yes
guest only = yes
writable = yes
browseable = yes
force user = arcade
inherit permissions = yes

sudo service smbd restart
git clone --depth=1 https://github.com/johnodon/Ubuntu-Server-ES-DE.git
mv ~/Ubuntu-Server-ES-DE/.config ~
rm -rf ~/Ubuntu-Server-ES-DE
mkdir ~/Applications
mkdir ~/Downloads
cd ~/Downloads
wget https://gitlab.com/es-de/emulationstation-de/-/package_files/210210324/download -O ES-DE_x64.AppImage
wget https://buildbot.libretro.com/stable/1.21.0/linux/x86_64/RetroArch.7z
p7zip -d ~/Downloads/RetroArch.7z
mv ES-DE_x64.AppImage ~/Applications/
mv RetroArch-Linux-x86_64/RetroArch-Linux-x86_64.AppImage ~/Applications/
mv RetroArch-Linux-x86_64/RetroArch-Linux-x86_64.AppImage.home/.config/retroarch ~/.config/
cd ~
rm -rf ~/Downloads/*
chmod +x ~/Applications/*
chmod 777 ~/Applications/*

sudo nano /etc/default/grub
GRUB_CMDLINE_LINUX_DEFAULT="quiet loglevel=0 fsck.mode=skip vt.global_cursor_default=0"
sudo update-grub
sudo usermod -a -G input arcade
sudo usermod -a -G audio arcade
sudo usermod -a -G video arcade
chown -R arcade:arcade ~

sudo rm /etc/issue
touch ~/.hushlogin
sudo systemctl disable getty@tty1.service --now
sudo apt-get purge cloud-init -y
sudo rm -rf /etc/cloud/ /var/lib/cloud/

git clone https://github.com/johnodon/Transparent_Cursor_Theme.git
sudo cp -R /home/pi/Transparent_Cursor_Theme/Transparent /usr/share/icons
sudo nano /usr/share/icons/default/index.theme
[Icon Theme]
Inherits=Transparent


sudo nano /etc/lightdm/lightdm.conf
[SeatDefaults]
autologin-user=arcade
autologin-user-timeout=0
user-session=openbox

sudo nano /etc/modprobe.d/blacklist-cros_ec_lpcs.conf
blacklist cros_ec_lpcs

Set HDMI to fallback in volume mixer (Openbox - pavucontrol)


sudo apt update -y && sudo apt dist-upgrade -y
wget -r -np -nH --cut-dirs=N -A "*.deb" https://repo.radeon.com/amdgpu-install/latest/ubuntu/noble/
sudo apt install ./amdgpu-install/latest/ubuntu/noble/*.deb -y
sudo amdgpu-install -y --usecase=workstation
sudo usermod -a -G input arcade
sudo usermod -a -G audio arcade
sudo usermod -a -G video arcade


#! /bin/bash
ROMPATH="$3"
ROM_BN_EXT="${ROMPATH##*/}"
ROM_BN="${ROM_BN_EXT%.*}"
CONTROLSIMAGE="/home/pi/RetroPie/roms/$1/images/$ROM_BN-controls.png"
feh --geometry +3840+0 "$CONTROLSIMAGE" &>/dev/null &


#! /bin/bash
killall feh &


#! /bin/bash
#set primary display and resolution.
xrandr --display :0 --output HDMI-1 --mode 1920x1080 --primary &
#call cvlc to play a startup animation.  Wait for it to end before continuing.
cvlc --random --play-and-stop --play-and-exit --fullscreen --video-on-top --no-video-title-show --quiet --gl=any --preferred-resolution=1080 ~/RetroPie/splashscreens &> /dev/null
#start ES in a terminal (openbox).
~/Applications/ES-DE*.AppImage &
